<h2 class="mb-3">Create your account</h2>

<!-- Messages globaux avec @if -->
@if (success()) {
  <p-message severity="success" [text]="success()!"></p-message>
}
@if (error()) {
  <p-message severity="danger" [text]="error()!"></p-message>
}

<form [formGroup]="form" (ngSubmit)="submit()" class="form">
  <div class="form-field">
    <label for="firstname">First name</label>
    <input
      id="firstname"
      type="text"
      pInputText
      formControlName="firstname"
      placeholder="John"
    />
    @if (f['firstname'].touched && f['firstname'].invalid) {
      <small class="error">First name is required</small>
    }
  </div>

  <div class="form-field">
    <label for="lastname">Last name</label>
    <input
      id="lastname"
      type="text"
      pInputText
      formControlName="lastname"
      placeholder="Doe"
    />
    @if (f['lastname'].touched && f['lastname'].invalid) {
      <small class="error">Last name is required</small>
    }
  </div>

  <div class="form-field">
    <label for="email">Email</label>
    <input
      id="email"
      type="email"
      pInputText
      formControlName="email"
      placeholder="john.doe@mail.com"
    />
    @if (f['email'].touched && f['email'].errors?.['required']) {
      <small class="error">Email is mandatory</small>
    }
    @if (f['email'].touched && f['email'].errors?.['email']) {
      <small class="error">Email format is invalid</small>
    }
  </div>

  <div class="form-field">
    <label for="password">Password</label>
    <input
      id="password"
      type="password"
      pPassword
      formControlName="password"
      [feedback]="false"
      placeholder="At least 8 chars"
    />
    @if (f['password'].touched && f['password'].errors?.['required']) {
      <small class="error">Password is mandatory</small>
    }
    @if (f['password'].touched && f['password'].errors?.['minlength']) {
      <small class="error">Password should be at least 8 characters</small>
    }
  </div>

  <p-button
    type="submit"
    label="Create account"
    [disabled]="form.invalid || loading()"
    [loading]="loading()"
    severity="success"
    class="mt-2"
  ></p-button>
</form>
